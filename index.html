<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Visual Novel ‚Äî San Valent√≠n</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- Base path configuration for GitHub Pages compatibility -->
    <script>
      // Calcula autom√°ticamente el base path para funcionar en local y en GitHub Pages
      (function() {
        let repoBase = window.location.pathname;
        
        // Si est√° en GitHub Pages, la ruta ser√° algo como:
        // /yazurvival-horror-VN/survival%20novel/ o 
        // /yazurvival-horror-VN/survival%20novel/index.html
        // Necesitamos extraer /yazurvival-horror-VN/
        
        if (repoBase.includes('survival')) {
          // Estamos dentro de survival novel, subir al repo base
          repoBase = repoBase.substring(0, repoBase.indexOf('survival')).replace(/\/$/, '') + '/';
        } else {
          // En local: usar rutas relativas (./dialogs/, ./assets/)
          repoBase = './';
        }
        
        // Guardar en window para que otros scripts lo usen
        window.REPO_BASE = repoBase;
        console.log('Repo base detectado:', window.REPO_BASE);
      })();
    </script>

    <div class="app">
      <main class="vn">
        <div class="scene" id="scene">
          <img id="sprite" class="sprite" alt="sprite" loading="eager" decoding="sync" />
          <div class="hearts" aria-hidden="true">
            <div class="hearts-scroll">
              <div class="hearts-track"></div>
            </div>
          </div>
        </div>

        <div id="titleScreen" class="title-screen" role="dialog" aria-label="Pantalla de t√≠tulo">          <div class="particles" aria-hidden="true"></div>
          <div class="floating-emojis" aria-hidden="true">
            <span class="emoji e1">üíñ</span>
            <span class="emoji e2">‚ú®</span>
            <span class="emoji e3">üíï</span>
            <span class="emoji e4">üå∏</span>
            <span class="emoji e5">üíú</span>
            <span class="emoji e6">‚ú®</span>
            <span class="emoji e7">üíó</span>
            <span class="emoji e8">üåô</span>
            <span class="emoji e9">üíù</span>
            <span class="emoji e10">‚ú®</span>
            <span class="emoji e11">üíñ</span>
            <span class="emoji e12">üå∏</span>
          </div>          <div class="title-content">
            <div class="title-genre">una novela visual de "terror"</div>
            <h1 class="title-main">Yazumimoon es tu gatita</h1>
            <div class="title-version">demo inicial</div>
            <p class="title-warning">intenta no desarrollar s√≠ndrome de estocolmo</p>
            <div class="start-hint">Pulsa o toca para comenzar</div>
          </div>
        </div>

        <div class="dialogue hidden" id="dialogue">
          <div class="meta">
            <div class="name" id="speaker"></div>
            <div class="controls">
              <button id="backBtn" title="Atr√°s">‚óÄ</button>
              <button id="nextBtn" title="Siguiente">‚ñ∂</button>
            </div>
          </div>

          <div class="text" id="text"></div>
          <div class="choices" id="choices" aria-live="polite"></div>
        </div>
      </main>
    </div>

    <audio id="sfxAudio" preload="auto"></audio>
    <audio id="musicAudio" loop preload="auto"></audio>
    <audio id="endSfxAudio" preload="auto"></audio>

    <div id="audioControls" class="audio-controls">
      <!-- Audio selection removed (configured from backend) -->
      <div class="music-select">
        <label>Musica: <select id="musicSelect">
          <option value="0">Silent Hill - Vocal</option>
          <option value="1">Silent Hill - Long</option>
        </select></label>
        <button id="restartNowBtn" title="Reiniciar">Reiniciar</button>
        <button id="backToDecisionNowBtn" title="√öltima decisi√≥n">Volver a decisi√≥n</button>
        <button id="routeDJumpBtn" title="Ir a ruta D" style="display:none;">Ir a Ruta D</button>
      </div>
      <div class="vols">
        <label>Vol m√∫sica <input id="musicVol" type="range" min="0" max="1" step="0.01" value="0.04"></label>
        <label>Vol efectos <input id="sfxVol" type="range" min="0" max="1" step="0.01" value="0.9"></label>
      </div>
    </div>

    <div id="endScreen" class="end-screen hidden" role="dialog" aria-label="Fin del juego">
      <div class="end-content">
        <h1 class="end-title">FIN DEL JUEGO</h1>
        <div class="end-buttons">
          <button id="restartBtn" class="btn">Reiniciar</button>
          <button id="lastDecisionBtn" class="btn">Volver a la √∫ltima decisi√≥n</button>
        </div>
      </div>
    </div>

    <!-- Final celebratory banner (shown after `final_verdadero`) -->
    <div id="finalBanner" class="final-banner hidden" role="dialog" aria-label="Celebraci√≥n final">
      <div class="final-particles" aria-hidden="true"></div>
      <div class="final-hearts" aria-hidden="true">
        <div class="hearts-scroll">
          <div class="hearts-track"></div>
        </div>
      </div>
      <div class="final-content">
        <div class="final-text">
          <div class="final-main">
            <div class="final-title">
              <span class="final-name">YAZUMIMOON</span>
              <div class="final-date">Feliz 14 de febrero.</div>
            </div>
            <div class="final-thanks">GRACIAS POR SIEMPRE SER T√ö MISMA.</div>
          </div>
          <div class="final-sub">(tu perfectamente imperfecta persona)</div>
        </div>
        <div class="final-actions">
          <button id="finalContinue" class="btn">Continuar</button>
        </div>
      </div>
    </div>

    <!-- Module scripts in dependency order -->
    <script src="js/characters.js"></script>
    <script src="js/interactions.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/script-parser.js"></script>
    <script src="js/sample-script.js"></script>
    <script src="js/game.js"></script>
    <!-- Main app initialization (loads last) -->
    <script src="app.js"></script>
  </body>
</html>