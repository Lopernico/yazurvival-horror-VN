/* ========================================
   VARIABLES GLOBALES Y RESET GENERAL
   TEMA: HORROR PSICOLÓGICO - SÓTANO OSCURO
   ======================================== */
/* Paleta de colores: tonos oscuros, óxido, sangre seca, concreto */
:root{
  --bg:#0d0605;               /* Negro profundo, casi sin luz */
  --accent:#8b2627;           /* Rojo óxido / sangre seca */
  --accent-2:#5a3a38;         /* Marrón/Óxido oscuro */
  --panel:rgba(139, 38, 39, 0.15);   /* Panel de óxido muy oscuro */
  --glass:rgba(50, 50, 50, 0.08);    /* Cristal sucio/polvoriento */
  --fog:#1a1815;              /* Color base para niebla */
  --blood:#4a1515;            /* Sangre seca */
  --rust:#6b3e3e;             /* Óxido */
  --concrete:#2a2620;         /* Concreto oscuro */
}

/* Reset universal y configuración base */
*{box-sizing:border-box}

/* Hace que html, body y #app ocupen toda la altura de la ventana */
html,body,#app{height:100%}

/* Estilos base del body - SÓTANO OSCURO CON NIEBLA */
body{
  margin:0;
  font-family:'Courier New',monospace,'Creepster','Horror';  /* Tipografía monoespaciada para efecto sinistro */
  /* Fondo: pared de concreto oscuro apenas iluminada */
  background:linear-gradient(180deg, #0a0805 0%, #1a1210 40%, #0d0605 70%, #0a0805 100%);
  background-attachment:fixed;
  color:#b89968;              /* Texto color sepia envejecido */
  display:flex;
  align-items:stretch;
  min-height:100vh;
  overflow:hidden;            /* Oculta barras de scroll */
  position:relative;
}

/* Efecto de niebla/humo constante en el fondo */
body::before{
  content:'';
  position:fixed;
  inset:0;
  background:
    radial-gradient(ellipse at 20% 50%, rgba(100, 50, 40, 0.4) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 30%, rgba(80, 40, 30, 0.3) 0%, transparent 50%),
    radial-gradient(ellipse at 50% 80%, rgba(60, 30, 20, 0.35) 0%, transparent 50%);
  background-size:200% 200%;
  animation:fogFlow 15s ease-in-out infinite;
  pointer-events:none;
  z-index:1;
}

/* Efecto de niebla oscura y flotante */
@keyframes fogFlow{
  0%{background-position:0% 0%, 100% 100%, 50% 0%}
  50%{background-position:100% 100%, 0% 0%, 50% 100%}
  100%{background-position:0% 0%, 100% 100%, 50% 0%}
}

/* Contenedor principal de la aplicación */
.app{
  display:grid;
  grid-template-columns:1fr;
  gap:0;
  padding:0;
  width:100vw;                /* Ancho completo de la ventana */
  height:100vh;               /* Alto completo de la ventana */
  max-width:none;
  margin:0;
  align-items:stretch;
  overflow:hidden;
  position:relative;
  z-index:2;  /* Sobre la niebla de body */
  will-change:transform,opacity;  /* Optimiza para cameraShake/wobble/zoom */
  perspective:1000px;         /* Habilita 3D transforms */
  backface-visibility:hidden;  /* Evita flickering */
  transform:translate3d(0,0,0); /* Activa hardware acceleration */
}

/* Luz intermitente tipo foco defectuoso */
.app::after{
  content:'';
  position:fixed;
  inset:0;
  background:radial-gradient(ellipse at center, rgba(255, 200, 100, 0) 0%, rgba(0,0,0,0.6) 100%);
  animation:flickeringLight 4s ease-in-out infinite;
  pointer-events:none;
  z-index:3;
}



/* Contenedor de la novela visual (VN = Visual Novel) - SÓTANO OSCURO */
.vn{
  background:linear-gradient(180deg, rgba(10,8,5,0.8), rgba(20,15,10,0.9));
  border-radius:0;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  height:100vh;
  border:none;
  box-shadow:inset 0 0 100px rgba(0,0,0,0.9), inset 0 0 200px rgba(50,25,15,0.5);
  position:relative;
  z-index:2;
}

/* Grietas y corrosión visual en la pared */
.vn::before{
  content:'';
  position:absolute;
  inset:0;
  background-image:
    linear-gradient(90deg, transparent 24%, rgba(150,100,80,0.05) 25%, rgba(150,100,80,0.05) 26%, transparent 27%, transparent 74%, rgba(150,100,80,0.05) 75%, rgba(150,100,80,0.05) 76%, transparent 77%, transparent),
    linear-gradient(0deg, transparent 24%, rgba(150,100,80,0.05) 25%, rgba(150,100,80,0.05) 26%, transparent 27%, transparent 74%, rgba(150,100,80,0.05) 75%, rgba(150,100,80,0.05) 76%, transparent 77%, transparent);
  background-size:50px 50px;
  opacity:0.1;
  pointer-events:none;
  z-index:0;
}

/* Elementos dentro de .vn se posicionan por encima del fondo */
.vn > *{position:relative;z-index:1}

/* Contenedor de la escena: aquí se muestran los personajes y diálogos */
.scene{
  flex:1;                     /* Ocupa el espacio disponible */
  position:relative;
  background:transparent;
  display:flex;
  align-items:center;
  justify-content:center;
  padding-bottom:10vh;        /* Espacio para el diálogo en la parte inferior */
  min-height:60vh;            /* Altura mínima del 60% de la ventana */
  will-change:contents;       /* Optimiza para cambios frecuentes */
} 
/* Pseudo-capa para el fondo de la escena. Usamos una variable CSS `--scene-bg`
   para que JS pueda cambiar la imagen sin conflictos con overlays o hijos. */
.scene::before{
  content: '';
  position: absolute;
  inset: 0;
  background-image: var(--scene-bg, none);
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
  filter: contrast(1.05) brightness(0.95);
  z-index: 0; /* Detrás del contenido de la escena */
  pointer-events: none;
}
.scene > *{ position: relative; z-index: 1; }
/* ========================================
   PANTALLA DE TÍTULO
   ======================================== */
/* Pantalla inicial de la novela visual que aparece al cargar */
.title-screen{
  position:absolute;
  inset:0;                    /* Cubre toda la pantalla */
  display:flex;
  align-items:center;
  justify-content:center;
  background:linear-gradient(180deg,rgba(8,2,6,0.35),rgba(16,4,12,0.65));
  z-index:50;                 /* Aparece encima de otros elementos */
  cursor:pointer;             /* Indica que es clickeable */
  text-align:center;
  padding:6vh 5vw;
  backdrop-filter: blur(4px); /* Efecto de desenfoque de vidrio */
  overflow:hidden;
}

/* NIEBLA Y VAPOR ANIMADO */
/* Simula niebla pesada en el sótano */
.particles{
  position:absolute;
  inset:0;                    /* Cubre toda el área */
  pointer-events:none;        /* No interfiere con clicks */
  /* Gradientes que simulan niebla/vapor denso */
  background-image: 
    radial-gradient(ellipse at 20% 50%, rgba(60, 40, 30, 0.3) 0, transparent 50%),
    radial-gradient(ellipse at 80% 80%, rgba(80, 50, 35, 0.25) 0, transparent 50%),
    radial-gradient(ellipse at 50% 0%, rgba(70, 45, 32, 0.28) 0, transparent 50%);
  background-size: 200% 200%;  /* Tamaño que permite animación */
  animation: fogFlow 12s ease-in-out infinite;
  z-index:1;
}

/* Animación que desplaza el background para crear efecto de movimiento de niebla */
@keyframes bgShift{
  0%{background-position:0% 0%, 100% 100%, 50% 0%} 
  50%{background-position:100% 100%, 0% 0%, 50% 100%}
  100%{background-position:0% 0%, 100% 100%, 50% 0%}
}

/* Animación de flujo de niebla similar */
@keyframes fogFlow{
  0%{background-position:0% 0%, 100% 100%, 50% 0%} 
  50%{background-position:100% 100%, 0% 0%, 50% 100%}
  100%{background-position:0% 0%, 100% 100%, 50% 0%}
}

/* EMOJIS FLOTANTES (ahora símbolos espectrales siniestros) */
/* Decoración animada: sombras espectrales flotando en el sótano */
.floating-emojis{
  position:absolute;
  inset:0;
  pointer-events:none;        /* No interfiere con interacciones */
  z-index:0;
  overflow:hidden;
}

/* Estilo base para símbolos espectrales */
.emoji{
  position:absolute;
  font-size:clamp(24px,4vw,48px);  /* Tamaño responsivo */
  opacity:0.3;                /* Muy transparentes - espectrales */
  animation:floatEmoji 8s ease-in-out infinite;
  filter:drop-shadow(0 4px 12px rgba(139,38,39,0.15)) blur(0.8px);  /* Sombra roja débil */
  color:#5a2020;              /* Rojo sangre seca */
  text-shadow:0 0 8px rgba(139,38,39,0.4);
}

/* Posicionamiento individual de cada símbolo (e1 a e12) */
.emoji.e1{left:5%;top:15%;animation-delay:0s;animation-duration:6.5s}
.emoji.e2{left:92%;top:8%;animation-delay:1.2s;animation-duration:7s}
.emoji.e3{left:10%;top:75%;animation-delay:0.4s;animation-duration:8.2s}
.emoji.e4{left:85%;top:70%;animation-delay:2s;animation-duration:7.8s}
.emoji.e5{left:50%;top:10%;animation-delay:0.8s;animation-duration:9s}
.emoji.e6{left:15%;top:45%;animation-delay:1.6s;animation-duration:6.8s}
.emoji.e7{left:88%;top:35%;animation-delay:0.2s;animation-duration:8.5s}
.emoji.e8{left:25%;top:82%;animation-delay:1.4s;animation-duration:7.2s}
.emoji.e9{left:75%;top:12%;animation-delay:0.6s;animation-duration:8.8s}
.emoji.e10{left:40%;top:85%;animation-delay:2.2s;animation-duration:7.5s}
.emoji.e11{left:5%;top:50%;animation-delay:0.9s;animation-duration:9.2s}
.emoji.e12{left:95%;top:55%;animation-delay:1.8s;animation-duration:6.9s}

/* Animación que hace que los símbolos floten atrapados en la niebla */
@keyframes floatEmoji{
  0%{transform:translateY(0) scale(1) rotate(0deg) skewY(-2deg)}
  25%{transform:translateY(-40px) scale(1.1) rotate(8deg) skewY(2deg)}
  50%{transform:translateY(-80px) scale(0.95) rotate(-4deg) skewY(0deg)}
  75%{transform:translateY(-40px) scale(1.05) rotate(6deg) skewY(-2deg)}
  100%{transform:translateY(0) scale(1) rotate(0deg) skewY(0deg)}
}

/* CONTENEDOR PRINCIPAL DEL TÍTULO */
.title-content{
  color: #8b6f47;
  max-width: 1100px;
  margin: auto;
  position: relative;
  z-index: 10;
  animation: vnTitleIn 1.2s cubic-bezier(.19,.85,.19,1) forwards, sway 2.5s ease-in-out 1.2s infinite;
  text-shadow: 0 8px 32px rgba(0,0,0,0.9), 0 0 20px rgba(139,38,39,0.4);
}

/* GÉNERO - línea superior pequeña */
.title-genre{
  font-size: clamp(12px, 1.8vw, 18px);
  margin: 0 0 12px 0;
  color: #7a5c3d;
  font-weight: 600;
  letter-spacing: 3px;
  text-transform: uppercase;
  opacity: 0.85;
  animation: fadeInSlow 1s ease-out both;
  font-family: 'Courier New', monospace;
  text-shadow: 0 2px 8px rgba(0,0,0,0.7);
}

/* TÍTULO PRINCIPAL - grande y decorado */
.title-main{
  font-size: clamp(32px, 8vw, 72px);
  margin: 0;
  font-weight: 900;
  letter-spacing: 1px;
  color: #c41e3a;
  font-family: 'Courier New', monospace;
  animation: popPulse 1.2s cubic-bezier(.19,.85,.19,1) 0.2s both;
  text-shadow: 
    0 8px 24px rgba(70,20,10,0.8),
    0 4px 12px rgba(139,38,39,0.7),
    0 0 20px rgba(196,30,58,0.5);
  filter: drop-shadow(0 6px 16px rgba(139,38,39,0.8));
  border-top: 2px solid rgba(196,30,58,0.6);
  border-bottom: 2px solid rgba(196,30,58,0.6);
  padding: 16px 0;
  margin: 20px 0;
}

/* VERSIÓN - línea pequeña debajo del título */
.title-version{
  font-size: clamp(14px, 1.6vw, 16px);
  margin: 12px 0;
  color: #a52a2a;
  font-weight: 600;
  letter-spacing: 2px;
  text-transform: uppercase;
  opacity: 0.9;
  animation: fadeInSlow 1.2s ease-out 0.4s both;
  font-family: 'Courier New', monospace;
  text-shadow: 0 2px 8px rgba(0,0,0,0.7);
}

/* ADVERTENCIA/NOTA - línea con énfasis */
.title-warning{
  font-size: clamp(13px, 1.5vw, 15px);
  margin: 16px 0;
  color: #6b4423;
  font-style: italic;
  font-weight: 500;
  letter-spacing: 1px;
  opacity: 0.85;
  animation: fadeInSlow 1.4s ease-out 0.6s both;
  font-family: 'Courier New', monospace;
  text-shadow: 0 2px 6px rgba(0,0,0,0.6);
}

/* Animación fade in lenta */
@keyframes fadeInSlow {
  from { opacity: 0; }
  to { opacity: 1; }
}
  color:#7a5c3d;
  opacity:0.95;
  animation:fadeInUp 1s cubic-bezier(.19,.85,.19,1) 0.6s both;  /* Aparece desde abajo */
  text-shadow:0 0 8px rgba(139,38,39,0.6);
  font-family:'Courier New',monospace;
}

/* CITA (texto descriptivo adicional) */
.quote{
  margin-top:10px;
  font-size:clamp(14px,1.6vw,18px);
  color:#6b4423;
  font-style:italic;            /* Texto en cursiva */
  opacity:0.95;
  animation:fadeInUp 1s cubic-bezier(.19,.85,.19,1) 0.8s both;
  text-shadow:0 0 8px rgba(139,38,39,0.5);
  font-family:'Courier New',monospace;
}

/* INDICACIÓN PARA INICIAR (botón/texto clickeable) */
.start-hint{
  margin-top:24px;
  padding:12px 22px;
  border-radius:2px;            /* Esquinas afiladas estilo metal */
  background:linear-gradient(90deg, rgba(70,35,30,0.6), rgba(90,50,35,0.5));
  color:#8b6f47;
  font-weight:800;
  display:inline-block;
  /* Dos animaciones: entrada + pulso continuo */
  animation:fadeInUp 1s cubic-bezier(.19,.85,.19,1) 1s both, rustPulse 2s ease-in-out 1.6s infinite;
  border:2px solid rgba(139,38,39,0.6);
  box-shadow:0 8px 24px rgba(0,0,0,0.8), inset 0 0 10px rgba(139,38,39,0.3);
  font-family:'Courier New',monospace;
  letter-spacing:1px;
}

/* Pulso de óxido (similar a pulse pero con colores de óxido) */
@keyframes rustPulse{
  0%{transform:scale(1);box-shadow:0 8px 24px rgba(0,0,0,0.8), inset 0 0 10px rgba(139,38,39,0.3)}
  50%{transform:scale(1.05);box-shadow:0 12px 32px rgba(139,38,39,0.4), inset 0 0 15px rgba(139,38,39,0.5)}
  100%{transform:scale(1);box-shadow:0 8px 24px rgba(0,0,0,0.8), inset 0 0 10px rgba(139,38,39,0.3)}
}

/* ANIMACIONES DEL TÍTULO */

/* Balanceo suave arriba y abajo */
@keyframes sway{
  0%, 100%{transform:translateY(0) scale(1)}
  50%{transform:translateY(-8px) scale(1.01)}  /* Sube ligeramente */
}

/* Título aparece desde abajo con escala */
@keyframes vnTitleIn{
  from{opacity:0;transform:translateY(12px) scale(.94)}
  to{opacity:1;transform:translateY(0) scale(1)}
}

/* Elemento salta hacia arriba al aparecer */
@keyframes popIn{
  from{opacity:0;transform:translateY(-20px) scale(.92)}
  to{opacity:1;transform:translateY(0) scale(1)}
}

/* Pequeño elemento crece desde 0 */
@keyframes fadeInSmall{
  from{opacity:0;transform:scale(.8)}
  to{opacity:1;transform:scale(1)}
}

/* Elemento salta y pulsa */
@keyframes popPulse{
  from{opacity:0;transform:scale(.7) translateY(10px)}
  to{opacity:1;transform:scale(1) translateY(0)}
}

/* Aparición suave desde abajo */
@keyframes fadeInUp{
  from{opacity:0;transform:translateY(8px)}
  to{opacity:1;transform:translateY(0)}
}

/* Pulso continuo de escala y sombra */
@keyframes pulse{
  0%{transform:scale(1);box-shadow:0 8px 24px rgba(255,107,154,0.15)}
  50%{transform:scale(1.05);box-shadow:0 12px 32px rgba(255,107,154,0.25)}  /* Crece y sombra más intensa */
  100%{transform:scale(1);box-shadow:0 8px 24px rgba(255,107,154,0.15)}
}

/* ========================================
   UTILIDADES Y SPRITES
   ======================================== */

/* Clase para ocultar elementos */
.hidden{display:none !important}

/* Personaje/sprite (imagen de personaje en la novela) - EN SOMBRAS */
.sprite{
  width:min(46.5vw,735px);     /* 75% del tamaño anterior (62vw→46.5vw, 980px→735px) */
  max-height:54vh;             /* 75% de 72vh */
  height:auto;                 /* Mantiene proporciones */
  transition:transform .35s ease,opacity .2s ease;  /* Animaciones suaves */
  transform-origin:center bottom;  /* Las transformaciones se hacen desde la base */
  filter:drop-shadow(0 30px 80px rgba(0,0,0,0.95)) drop-shadow(0 0 40px rgba(139,38,39,0.3)) grayscale(0.3);  /* Sombra dramática + desaturación */
  opacity:0.95;
  will-change:transform,opacity;  /* Optimiza para navegador */
  image-rendering:crisp-edges;  /* Evita pixelación al escalar */
  backface-visibility:hidden;   /* Evita flickering en 3D transforms */
  transform:translate3d(0,0,0); /* Activa hardware acceleration */
}

/* ========================================
   FONDO CON IMAGEN DE SÓTANO HORROR
   ======================================== */
/* Contenedor del fondo - IMAGEN DEL SÓTANO */
.hearts{
  position:absolute;
  inset:0;                    /* Cubre todo */
  pointer-events:none;        /* No interfiere */
  width:100%;
  height:100%;
  overflow:hidden;
  z-index:-1;                 /* Detrás de otros elementos */
  background-image:url('./assets/creepy-horror-basement-ghost-bq7vqpkb7tasbpwt.png');
  background-size:cover;      /* Rellena toda el área */
  background-position:center; /* Centrada siempre */
  background-attachment:fixed;  /* No se mueve con scroll */
  background-repeat:no-repeat;
  /* Filtros para hacer la imagen más siniestra y vistosa */
  filter: contrast(1.2) brightness(0.7) saturate(1.3) hue-rotate(-5deg) drop-shadow(0 0 30px rgba(139,38,39,0.4));
}

/* Overlay oscuro sobre la imagen para mayor control */
.hearts::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(180deg, rgba(10,5,3,0.3), rgba(20,10,5,0.4));
  z-index:1;
  pointer-events:none;
}

/* Zona de desplazamiento - OCULTA */
.hearts-scroll{
  display:none;  /* Oculta completamente */
}

/* Capa de superposición oscura - OCULTA */
.hearts-scroll::before{
  display:none;  /* Oculta */
}

/* Contenedor de las filas - OCULTO */
.hearts-track{
  display:none;  /* Oculta */
}

/* Fila individual - OCULTA */
.heart-row{
  display:none;  /* Oculta */
}

/* Cada gota de sangre - OCULTA */
.hearts-track span{
  display:none;  /* Oculta */
}

/* Animación - MANTENIDA POR COMPATIBILIDAD PERO NO SE USA */
@keyframes horizontalScroll{
  0%{transform:translateX(0)}
  100%{transform:translateX(-50%)}
}

/* ========================================
   PANTALLA FINAL / BANNER DE CRÉDITOS
   ======================================== */
/* Contenedor principal que aparece al final de la novela - FINAL OSCURO */
.final-banner{
  position:fixed;
  inset:0;                    /* Cubre toda la pantalla */
  display:flex;
  align-items:center;
  justify-content:center;
  background:linear-gradient(180deg, rgba(10,5,3,0.95), rgba(20,10,5,0.98));
  z-index:220;                /* Por encima de todo */
  padding:6vh 5vw;
  box-shadow:inset 0 0 150px rgba(0,0,0,0.95);
}
/* Partículas animadas en el banner final - NIEBLA FINAL */
.final-banner .final-particles{
  position:absolute;
  inset:0;
  background-image:radial-gradient(circle at 20% 50%, rgba(70,40,30,0.3) 0, transparent 40%), radial-gradient(circle at 80% 80%, rgba(60,30,20,0.25) 0, transparent 40%);
  background-size:200% 200%;
  animation:fogFlow 9s ease-in-out infinite;
  opacity:0.8;
}

/* Contenedor de corazones en el banner final */
.final-banner .final-hearts{
  position:absolute;
  inset:0;
  pointer-events:none;
  width:100%;
  height:100%;
  overflow:hidden;
  z-index:-1;
  background-image:url('./assets/creepy-horror-basement-ghost-bq7vqpkb7tasbpwt.png');
  background-size:cover;
  background-position:center;
  background-attachment:fixed;
  background-repeat:no-repeat;
  /* Filtros aplicados también aquí */
  filter: contrast(1.15) brightness(0.65) saturate(1.2) hue-rotate(-5deg) drop-shadow(0 0 25px rgba(139,38,39,0.3));
}

/* Overlay para el banner final - OCULTO */
.final-banner .final-hearts .hearts-scroll{
  display:none;
}

.final-banner .final-hearts .hearts-scroll::before{
  display:none;
}

.final-banner .final-hearts .hearts-track{
  display:none;
}

.final-banner .final-hearts .heart-row{
  display:none;
}

.final-banner .final-hearts .hearts-track span{
  display:none;
}
/* Caja de contenido principal del banner final - METAL OXIDADO */
.final-content{
  position:relative;
  z-index:10;
  padding:36px 48px;
  border-radius:0;
  background:linear-gradient(180deg, rgba(40,25,20,0.9), rgba(30,18,15,0.95));  /* Metal oxidado */
  backdrop-filter: blur(6px);  /* Desenfoque */
  border:2px solid rgba(139,38,39,0.8);
  box-shadow:0 30px 80px rgba(0,0,0,0.9), inset 0 0 30px rgba(139,38,39,0.2), inset 0 0 60px rgba(0,0,0,0.5);  /* Sombra profunda */
  text-align:center;
  max-width:920px;
}

/* Texto dentro del banner final */
.final-text{color:#8b6f47}  /* Sepia envejecido */

/* Contenedor principal de contenido */
.final-main{
  display:block;
  margin:0 auto;
  max-width:880px;
}

/* ========================================
   TÍTULO DEL BANNER FINAL
   ======================================== */
/* Sección del título (ej: nombre del autor/titulo) */
.final-title{margin-bottom:14px}

/* Nombre/título principal con animación por letra - ÓXIDO */
.final-name{
  display:inline-block;
  font-family:'Courier New',monospace;
  font-weight:900;
  color:#a52a2a;              /* Rojo sangre seca */
  font-size:clamp(36px,8.6vw,96px);  /* Muy grande y responsivo */
  letter-spacing:2px;
  text-transform:uppercase;
  animation:finalNamePulse 1.2s ease-in-out both;  /* Animación de aparición */
  filter:drop-shadow(0 12px 30px rgba(139,38,39,0.6));
  text-shadow:0 0 20px rgba(139,38,39,0.5);
}

/* Cada letra del nombre (para animación individual) */
.final-name span{
  display:inline-block;
  transform-origin:center bottom;  /* Las transformaciones se hacen desde la base */
  animation:letterPop .8s cubic-bezier(.19,.85,.19,1) both;  /* Cada letra salta secuencialmente */
}

/* Animación del nombre: salta hacia arriba y aparece */
@keyframes finalNamePulse{
  0%{transform:translateY(8px) scale(.96);opacity:0}
  30%{transform:translateY(-8px) scale(1.04);opacity:1}  /* Pico del movimiento */
  100%{transform:translateY(0) scale(1);opacity:1}  /* Posición final */
}

/* Animación individual de cada letra: salta más alto */
@keyframes letterPop{
  0%{transform:translateY(18px) scale(.86);opacity:0}
  60%{transform:translateY(-8px) scale(1.08);opacity:1}  /* Pico exagerado */
  100%{transform:translateY(0) scale(1);opacity:1}
}

/* ========================================
   FECHA Y AGRADECIMIENTOS
   ======================================== */

/* Fecha mostrada en el banner final */
.final-date{
  font-size:clamp(14px,2.2vw,22px);
  color:#7a5c3d;              /* Sepia */
  margin-top:6px;
  opacity:0.95;
  animation:dateFloat 3s ease-in-out infinite;  /* Flota arriba y abajo */
  font-family:'Courier New',monospace;
  text-shadow:0 0 10px rgba(139,38,39,0.4);
}

/* Animación de flotación para la fecha */
@keyframes dateFloat{
  0%{transform:translateY(0)}
  50%{transform:translateY(-6px)}    /* Sube ligeramente */
  100%{transform:translateY(0)}
}

/* Agradecimientos (animación palabra por palabra) */
.final-thanks{
  font-size:clamp(18px,3.8vw,40px);  /* Grande y responsivo */
  color:#a52a2a;              /* Rojo sangre seca */
  font-weight:900;
  line-height:1.02;
  margin-top:6px;
  text-align:center;
  word-break:break-word;       /* Permite divisiones de palabras */
  font-family:'Courier New',monospace;
  text-shadow:0 0 15px rgba(139,38,39,0.5);
}

/* Cada palabra de agradecimiento (con animación individual) */
.final-thanks .thanks-word{
  display:inline-block;
  opacity:0;
  transform:translateY(12px);
  animation:thanksWord .7s cubic-bezier(.2,.85,.2,1) forwards;  /* Palabra por palabra */
}

/* Animación que hace que cada palabra salte hacia arriba */
@keyframes thanksWord{
  0%{transform:translateY(18px) scale(.98);opacity:0}
  60%{transform:translateY(-6px) scale(1.04);opacity:1}  /* Pico de animación */
  100%{transform:translateY(0) scale(1);opacity:1}  /* Posición final */
}

/* Subtítulo sutil en el banner final */
.final-sub{
  margin-top:12px;
  font-size:14px;
  color:#ffffff;
  font-style:italic;            /* Texto cursivo */
  opacity:0.95;
}

/* ========================================
   EFECTOS DE CELEBRACIÓN (confeti y corazones)
   ======================================== */
/* Estos elementos se crean dinámicamente con JavaScript */

/* Pieza de confeti y corazón estallado (posición inicial) */
.confetti-piece, .burst-heart{
  position:absolute;
  left:50%;
  top:35%;
  transform:translate(-50%,-50%);  /* Centrado */
  pointer-events:none;
  z-index:30;
}

/* Pequeño rectángulo de confeti */
.confetti-piece{
  width:10px;
  height:14px;
  border-radius:2px;            /* Ligeramente redondeado */
  mix-blend-mode:screen;        /* Se mezcla con el fondo */
  animation:confettiBurst var(--d,1200ms) cubic-bezier(.2,.8,.2,1) forwards;  /* Explota */
}

/* Corazón que estalla */
.burst-heart{
  font-size:20px;
  animation:heartBurst var(--d,1200ms) cubic-bezier(.2,.8,.2,1) forwards;  /* Explota */
}

/* Animación de explosión de confeti (hacia afuera y desaparece) */
@keyframes confettiBurst{
  0%{opacity:1;transform:translate(-50%,-50%) scale(1)}
  40%{opacity:1}  /* Permanece visible la mayor parte */
  100%{opacity:0;transform:translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) rotate(var(--rot)) scale(.9)}  /* Sale y desaparece */
}

/* Animación de explosión de corazones (hacia afuera con escala) */
@keyframes heartBurst{
  0%{opacity:1;transform:translate(-50%,-50%) scale(.8)}
  60%{opacity:1}  /* Permanece visible más tiempo que confeti */
  100%{opacity:0;transform:translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) rotate(var(--rot)) scale(1.1)}  /* Sale más grande */
}
/* Botones de acciones en el banner final */
.final-actions{
  margin-top:18px;
}

.final-actions .btn{
  padding:10px 18px;
  border-radius:0;              /* Esquinas afiladas estilo industrial */
  background:linear-gradient(90deg, rgba(70,35,30,0.8), rgba(90,50,35,0.7));  /* Óxido */
  color:#8b6f47;
  border:2px solid rgba(139,38,39,0.8);
  cursor:pointer;
  box-shadow:0 12px 40px rgba(0,0,0,0.8), inset 0 0 10px rgba(139,38,39,0.3);
  font-family:'Courier New',monospace;
  font-weight:bold;
  letter-spacing:1px;
}

/* Animación de aparición de botones */
@keyframes finalPop{
  from{opacity:0;transform:translateY(12px) scale(.96)}
  to{opacity:1;transform:translateY(0) scale(1)}
}

/* ========================================
   CAJA DE DIÁLOGO (parte inferior de la novela)
   ======================================== */
/* Cuadro donde aparecen los diálogos de los personajes - METAL HERRUMBROSO */
.dialogue{
  position:absolute;
  left:50%;
  transform:translateX(-50%);   /* Centrado horizontalmente */
  bottom:28px;                 /* A 28px del fondo */
  width:min(94%,1100px);       /* Responsivo: 94% ancho o máximo 1100px */
  padding:22px 26px;
  border-radius:0;
  background:linear-gradient(180deg, rgba(30,18,15,0.85), rgba(25,14,10,0.95));  /* Concreto/Metal oscuro */
  backdrop-filter: blur(6px);  /* Desenfoque */
  border:2px solid rgba(139,38,39,0.7);
  box-shadow:0 20px 60px rgba(0,0,0,0.95), inset 0 0 20px rgba(139,38,39,0.15), inset 0 0 40px rgba(0,0,0,0.4);  /* Sombra profunda con inset */
}
/* Metadata del diálogo (nombre y controles) */
.dialogue .meta{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}

/* Nombre del personaje que habla */
.name{
  font-weight:900;
  color:#ff6b6b;              /* Rojo más brillante y claro */
  font-size:16px;
  font-family:'Courier New',monospace;
  letter-spacing:2px;
  text-shadow:0 0 12px rgba(0,0,0,0.9), 0 0 5px rgba(255,107,107,0.6);
}

/* Símbolo antes del nombre del personaje */
.name::before{
  content:"♦";                /* Símbolo de diamante en lugar de corazón */
  margin-right:8px;
  color:#8b2627;              /* Rojo óxido */
  opacity:.8;
  font-size:12px;
}

/* Texto del diálogo */
.text{
  font-size:clamp(17px,2.4vw,22px);  /* Responsivo, más grande */
  line-height:1.7;             /* Espaciado de línea más generoso */
  min-height:96px;             /* Altura mínima para múltiples líneas */
  color:#e8d5c4;              /* Color más claro y cálido */
  font-family:'Courier New',monospace;
  letter-spacing:0.3px;
  text-shadow:0 0 8px rgba(0,0,0,0.95), 0 0 3px rgba(0,0,0,0.7);
  font-weight:500;
} 
/* ========================================
   CONTROLES Y OPCIONES DE DIÁLOGO
   ======================================== */

/* Botones de control (ej: siguiente, avanzar) */
.controls button{
  background:linear-gradient(90deg, rgba(70,35,30,0.8), rgba(90,50,35,0.7));  /* Óxido */
  border:2px solid rgba(139,38,39,0.7);
  color:#8b6f47;              /* Sepia */
  padding:8px 12px;
  border-radius:0;
  cursor:pointer;
  font-weight:700;
  box-shadow:0 10px 30px rgba(0,0,0,0.7), inset 0 0 8px rgba(139,38,39,0.2);
  margin-left:8px;
  font-family:'Courier New',monospace;
  letter-spacing:1px;
}

/* Botones deshabilitados (grises) */
.controls button:disabled{
  opacity:.3;
  cursor:default;
}

/* Contenedor de opciones de respuesta (choices) */
.choices{
  margin-top:12px;
  display:flex;
  flex-wrap:wrap;              /* Las opciones se envuelven en múltiples líneas */
  gap:8px;
}

/* Botón individual de opción de respuesta */
.choices button{
  background:linear-gradient(180deg, rgba(80,45,35,0.8), rgba(50,25,15,0.9));  /* Óxido más visible */
  border:2px solid rgba(255,107,107,0.7);
  padding:16px 24px;
  border-radius:0;
  color:#f0e4d7;              /* Texto más claro */
  cursor:pointer;
  box-shadow:0 10px 28px rgba(0,0,0,0.8), inset 0 0 10px rgba(139,38,39,0.2);
  transition:transform .16s ease,filter .16s ease;  /* Animaciones suaves al pasar */
  font-size:clamp(15px,1.8vw,19px);  /* Responsivo, más grande */
  font-family:'Courier New',monospace;
  letter-spacing:0.5px;
  font-weight:bold;
}

/* Hover con efecto de luz intermitente */
.choices button:hover{
  transform:translateY(-2px);  /* Se eleva poco */
  filter:brightness(1.1) drop-shadow(0 0 10px rgba(139,38,39,0.6));
  box-shadow:0 10px 28px rgba(139,38,39,0.3), inset 0 0 10px rgba(139,38,39,0.4);
}

/* Hover duplicado (la segunda anula la primera) */
.choices button:hover{
  transform:translateY(-2px);
  filter:brightness(1.08) drop-shadow(0 0 8px rgba(139,38,39,0.5));
}


/* ========================================
   EDITOR DE GUIÓN (panel lateral)
   ======================================== */
/* Panel para editar el script/diálogo - METAL OXIDADO */
.editor{
  background:linear-gradient(180deg, rgba(30,18,15,0.9), rgba(25,14,10,0.95));  /* Oscuro */
  padding:14px;
  border-radius:0;
  border:2px solid rgba(139,38,39,0.6);
  max-height:720px;             /* Alto máximo */
  overflow:auto;                /* Scroll si es necesario */
  box-shadow:inset 0 0 15px rgba(0,0,0,0.8);
}

/* Título dentro del editor */
.editor h2{
  margin:4px 0 8px;
  font-size:18px;
  color:#8b6f47;
  font-family:'Courier New',monospace;
  text-shadow:0 0 8px rgba(139,38,39,0.4);
}

/* Textarea para editar scripts */
#scriptEditor{
  width:100%;
  height:300px;
  background:rgba(5,3,1,0.9);  /* Casi negro */
  color:#8b6f47;              /* Sepia */
  border-radius:0;
  border:1px solid rgba(139,38,39,0.4);
  padding:12px;
  font-family:'Courier New',monospace;  /* Fuente monoespaciada */
  font-size:13px;
  resize:vertical;             /* Permite redimensionar verticalmente */
  text-shadow:0 0 3px rgba(0,0,0,0.8);
}

/* Controles del editor (botones) */
.editor-controls{
  margin-top:8px;
  display:flex;
  gap:8px;
}

.editor-controls button{
  background:linear-gradient(90deg, rgba(70,35,30,0.8), rgba(90,50,35,0.7));  /* Óxido */
  border:2px solid rgba(139,38,39,0.7);
  color:#8b6f47;              /* Sepia */
  padding:8px 10px;
  border-radius:0;
  cursor:pointer;
  font-family:'Courier New',monospace;
  font-weight:bold;
  box-shadow:0 4px 12px rgba(0,0,0,0.6), inset 0 0 8px rgba(139,38,39,0.2);
}

/* Esquema/información de formato JSON */
.schema{
  background:rgba(0,0,0,0.3);
  color:#8b6f47;              /* Sepia */
  padding:8px;
  border-radius:0;
  border:1px solid rgba(139,38,39,0.3);
  margin-top:10px;
  overflow:auto;               /* Scroll si es necesario */
  font-family:'Courier New',monospace;
  font-size:12px;
}

/* Nota de ayuda */
.note{
  font-size:13px;
  color:#8b6f47;              /* Sepia */
  margin-top:8px;
  font-family:'Courier New',monospace;
  text-shadow:0 0 5px rgba(0,0,0,0.8);
}
/* ========================================
   RESPONSIVE (para pantallas pequeñas)
   ======================================== */
/* En pantallas menores a 980px de ancho */
@media(max-width:980px){
  .app{grid-template-columns:1fr}  /* Una sola columna */
  .editor{order:2}              /* Editor va abajo */
  .vn{order:1}                  /* Novel visual va arriba */
}

/* ========================================
   CONTROLES DE AUDIO
   ======================================== */
/* Panel flotante en la esquina superior derecha para controles de sonido */
.audio-controls{
  position:fixed;
  right:18px;                  /* 18px desde la derecha */
  top:18px;                    /* 18px desde la parte superior */
  background:linear-gradient(180deg, rgba(30,18,15,0.85), rgba(25,14,10,0.95));  /* Metal oscuro */
  padding:12px;
  border-radius:0;
  border:2px solid rgba(139,38,39,0.6);
  backdrop-filter:blur(6px);   /* Cristal frosted */
  z-index:120;                 /* Encima de muchos elementos */
  color:#8b6f47;              /* Sepia */
  box-shadow:0 4px 12px rgba(0,0,0,0.8), inset 0 0 8px rgba(139,38,39,0.15);
}

/* Etiqueta dentro de controles de audio */
.audio-controls label{
  display:block;
  font-size:13px;
  margin:6px 0;
  font-family:'Courier New',monospace;
  color:#8b6f47;
  letter-spacing:0.5px;
}

/* Input de archivo para carga de audio */
.audio-controls input[type=file]{
  display:inline-block;
}

/* Contenedor de sliders de volumen */
.audio-controls .vols{
  display:flex;
  gap:10px;
  margin-top:8px;
}

/* Slider de control de volumen */
.audio-controls input[type=range]{
  width:120px;
}

/* ========================================
   PANTALLA DE FIN DEL JUEGO
   ======================================== */
/* Pantalla que aparece cuando se alcanza el final (game over screen) */
.end-screen{
  position:fixed;
  inset:0;                    /* Cubre toda la pantalla */
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,0.95);  /* Fondo casi completamente oscuro */
  z-index:200;                /* Muy por encima */
  box-shadow:inset 0 0 200px rgba(0,0,0,0.99);
}

/* Contenido dentro de la pantalla de fin */
.end-content{
  text-align:center;
  color:#8b6f47;              /* Sepia */
}

/* Título de la pantalla de fin (ej: "FIN") */
.end-title{
  font-size:clamp(36px,8vw,120px);  /* Responsivo y muy grande */
  color:#5a2020;              /* Sangre seca oscura */
  text-shadow:0 20px 40px rgba(0,0,0,0.95), 0 2px 8px rgba(139,38,39,0.6);  /* Sombras profundas */
  font-family:'Courier New',monospace;  /* Fuente monoespaciada */
  letter-spacing:6px;         /* Espaciado muy estandarizado */
  transform:none;             /* Sin inclinación */
  animation:pulseTitle 2s ease-in-out infinite;
}

/* Pulso del título final */
@keyframes pulseTitle{
  0%{text-shadow:0 20px 40px rgba(0,0,0,0.95), 0 2px 8px rgba(139,38,39,0.3)}
  50%{text-shadow:0 20px 40px rgba(0,0,0,0.95), 0 2px 20px rgba(139,38,39,0.8)}
  100%{text-shadow:0 20px 40px rgba(0,0,0,0.95), 0 2px 8px rgba(139,38,39,0.3)}
}

/* Botones de la pantalla de fin */
.end-buttons{
  margin-top:20px;
  display:flex;
  gap:12px;
  justify-content:center;
}

.end-buttons .btn{
  padding:10px 18px;
  border-radius:0;
  background:linear-gradient(180deg, rgba(70,35,30,0.9), rgba(50,25,20,0.95));  /* Óxido oscuro */
  color:#8b6f47;              /* Sepia */
  border:2px solid rgba(139,38,39,0.9);
  cursor:pointer;
  box-shadow:0 6px 22px rgba(0,0,0,0.9), inset 0 0 10px rgba(139,38,39,0.3);
  font-family:'Courier New',monospace;
  font-weight:bold;
  letter-spacing:1px;
}

.end-buttons .btn:hover{
  background:linear-gradient(180deg, rgba(90,45,40,0.9), rgba(70,35,30,0.95));
  box-shadow:0 6px 22px rgba(139,38,39,0.5), inset 0 0 15px rgba(139,38,39,0.4);
}

/* ========================================
   EFECTO DE DESVANECIMIENTO
   ======================================== */
/* Clase para difuminar la novela visual (durante eventos especiales) */
.vn.dimmed{
  filter:grayscale(.4) brightness(.25) blur(3px);  /* Más desaturación, más oscuro, más enfoque siniestro */
}

/* ========================================
   ESTILOS PARA NUEVOS EFECTOS
   ======================================== */
/* Flashback - opacidad reducida y desaturado */
.flashback-text{
  opacity:0.3;
  filter:saturate(0.6) brightness(0.8);
  color:#8b6f47;
  font-style:italic;
}

/* Pensamiento - estilo diferente */
.thought-text{
  color:#9d8b7a;
  font-style:italic;
  letter-spacing:1px;
}

/* Narración - normal pero puede tener efectos aplicados */
.narration-text{
  color:#b89968;
  letter-spacing:0px;
}

/* Hint - pequeño texto al pie */
#hint{
  position:fixed;
  bottom:20px;
  left:20px;
  right:20px;
  max-width:400px;
  padding:12px;
  background:rgba(139, 38, 39, 0.3);
  border:1px solid rgba(139, 38, 39, 0.6);
  color:#8b6f47;
  font-size:12px;
  font-style:italic;
  border-radius:4px;
  opacity:0;
  transition:opacity 0.5s ease;
  pointer-events:none;
  z-index:1000;
}

#hint.show{
  opacity:1;
}

/* Animación para fade-in desde la izquierda */
@keyframes fadeInFromLeft{
  from{
    opacity:0;
    transform:translateX(-100px);
  }
  to{
    opacity:1;
    transform:translateX(0);
  }
}

/* Animación para shake (temblor) */
@keyframes shake{
  0%, 100%{transform:translate(0, 0)}
  10%{transform:translate(-5px, 5px)}
  20%{transform:translate(5px, -5px)}
  30%{transform:translate(-5px, -5px)}
  40%{transform:translate(5px, 5px)}
  50%{transform:translate(-5px, 5px)}
  60%{transform:translate(5px, -5px)}
  70%{transform:translate(-5px, -5px)}
  80%{transform:translate(5px, 5px)}
  90%{transform:translate(-5px, 5px)}
}

/* Animación para zoom */
@keyframes zoom{
  from{transform:scale(1)}
  to{transform:scale(1.02)}
}

/* Animación para fade-to-black */
@keyframes fadeToBlack{
  from{opacity:1}
  to{opacity:0}
}

/* Estilos de voz progresiva */
.voice-small{
  font-size:14px;
}

.voice-normal{
  font-size:18px;
}

.voice-large{
  font-size:24px;
  text-transform:uppercase;
  letter-spacing:2px;
}
